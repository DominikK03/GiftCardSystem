services:
    # Test environment - disable TenantAwareEventStore decorator
    # This allows existing GiftCard tests to work without TenantContext
    Broadway\EventStore\EventStore:
        class: Broadway\EventStore\Dbal\DBALEventStore
        arguments:
            - '@doctrine.dbal.default_connection'
            - '@broadway.serializer.reflection'
            - '@broadway.serializer.reflection'
            - 'events'
            - false

    # Disable HMAC Authentication Middleware in test environment
    # Allows existing tests to run without authentication headers
    App\Infrastructure\Tenant\Security\HmacAuthenticationMiddleware:
        class: stdClass  # Replace with dummy class to disable

    # Use no-op Mercure hub in tests to avoid external HTTP/update side effects.
    Symfony\Component\Mercure\HubInterface: '@App\Infrastructure\Mercure\NullHub'
